//CrackMe.c - Programa para teste de Buffer Overflow
//--------------------------------------------------
//O programa utiliza a funcao strcpy() para copiar
//a entrada do usuario para um buffer de 40 bytes
//e a seguir printa na tela a mensagem digitada
//
//Este programa eh exploitado pelo exp_crackme.py
//que causa um Buffer Overflow retornando um /bin/sh
//
//compilar com: gcc corrupt.c -m32 -z execstack -fno-stack-protector -no-pie -w -o corrupt
//
//Se seu sistema eh 64bits, execute isso antes:
//dpkg --add-architecture i386
//apt-get update
//apt-get install libc6:i386 libc6-dev:i386 libncurses5:i386 libstdc++6:i386 gcc-multilib
//
//Para o programa ficar ainda mais interessante, ligue o suid bit como root:
//# chmod u+s crackme
//
//Assim o programa roda com privilegio de administrador, e se conseguimor chamar uma
//shell por aki teremos o controla total do sistema :)
//---
//Ivan S. Vargas | contato@is5.com.br
//11/2017
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>

//para facilitar a vida :)
void jmpesp() {
         __asm__("jmp *%esp"); 
}

int main(int argc, char **argv) {
	char buffer[40];

	if(argc == 1) {
		errx(1, "Digite alguma coisa...\n\r");
	}

	strcpy(buffer, argv[1]);

	printf("Vc digitou: %s\n\r",buffer);
}
